# React dev WebSocket bug

A reproduction of a bug where WebSockets created in a React component connect twice.
This only happens when the app is started in development mode with `yarn start` but not when the app is served in production from the files generated by `yarn build`.

This project was created using `npx create-react-app websocket-bug` with no dependencies added.

## Steps to reproduce

```shell
yarn
yarn start
```
## Expected behaviour

One websocket connection is made to `echo.websocket.org`.

## Actual behaviour

Two websocket connections are made to `echo.websocket.org`, which are visible in the "Network" tab in browser dev tools.

## Other info

Note that only one websocket connection is seen when built for production:

```shell
yarn build
serve -s build
```

I believe the bug is to do with React because when creating a websocket with `new WebSocket('wss://echo.websocket.org')` only one websocket connection is made.

## Environment

Node 12.20.1
Test on Chromium 87.0.4280.141 and Firefox 84.0.2 on Ubuntu 20.04.
